<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
	<title>MoSy upload mockdata</title>
</h:head>

<h:outputStylesheet name="primeicons/primeicons.css"
	library="primefaces" />

<h:body>

	<h:form id="form">

		<p:growl id="common_growl" for="common_growl" showDetail="true"
			life="1000">
			<p:autoUpdate />
		</p:growl>

		<p:panel id="pan_um">

			<p:messages id="info" showDetail="true" closeable="true" for="info"
				escape="false">
				<p:autoUpdate />
			</p:messages>
			<p:messages id="warn" showDetail="true" closeable="true" for="warn"
				escape="false">
				<p:autoUpdate />
			</p:messages>
			<p:messages id="error" showDetail="true" closeable="true" for="error"
				escape="false">
				<p:autoUpdate />
			</p:messages>
			<p:messages id="fatal" showDetail="true" closeable="true" for="fatal"
				escape="false">
				<p:autoUpdate />
			</p:messages>

			<p:ajaxStatus onstart="PF('statusDialog').show()"
				onsuccess="PF('statusDialog').hide()" />

			<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
				closable="false" resizable="false" showHeader="false">
				<p:graphicImage name="/images/loading.gif" />
			</p:dialog>

			<div class="ui-g">

				<div class="ui-g-12">
					<p:menubar>
						<p:menuitem id="men_refresh" value="#{labels.refresh}"
							action="#{uploadMockdata.refresh}" icon="pi pi-refresh"
							update=":form" />

						<f:facet name="options">
							<p:commandButton id="btnLogout" value="#{labels.logout}"
								icon="pi pi-home" action="#{uploadMockdata.logout()}"
								process="@this" />
						</f:facet>
					</p:menubar>
				</div>

				<div class="ui-g-12">

					<h:panelGrid id="pangr_um" columns="2" cellpadding="4">

						<h:outputText for="mockSessionSelected"
							value="#{labels.mock_session}" />
						<p:selectOneMenu id="mockSessionSelected"
							value="#{uploadMockdata.mockSessionSelected}"
							converter="MockSessionConverter">
							<f:selectItem itemLabel="#{labels.select_mock_session}"
								itemValue="" noSelectionOption="true" />
							<f:selectItems value="#{uploadMockdata.mockSessions}" />
						</p:selectOneMenu>

						<p:separator />
						<p:separator />

						<h:outputText for="mdTitle"
							value="#{labels.mockdata_title_prefix}" />
						<p:inputText id="mdTitle" value="#{uploadMockdata.titlePrefix}" />

						<p:selectBooleanCheckbox
							value="#{uploadMockdata.titlePostfixTimestamp}"
							itemLabel="#{labels.mockdata_title_postfix_timestamp}">
						</p:selectBooleanCheckbox>
						<div />

						<p:separator />
						<p:separator />

						<h:outputText for="interfaceSelected" value="#{labels.interface}" />
						<p:selectOneMenu id="interfaceSelected"
							value="#{uploadMockdata.interfaceSelected}"
							converter="InterfaceConverter">
							<f:selectItem itemLabel="#{labels.select_interface}" itemValue=""
								noSelectionOption="true" />
							<f:selectItems value="#{uploadMockdata.interfaces}" />
							<p:ajax listener="#{uploadMockdata.handleInterfaceSelection}"
								update="pan_um" process="pangr_um" />
						</p:selectOneMenu>

						<h:outputText for="methodSelected" value="#{labels.method}" />
						<p:selectOneMenu id="methodSelected"
							value="#{uploadMockdata.methodSelected}"
							converter="InterfaceMethodConverter">
							<f:selectItem itemLabel="#{labels.select_method}" itemValue=""
								noSelectionOption="true" />
							<f:selectItems value="#{uploadMockdata.methods}" />
						</p:selectOneMenu>

					</h:panelGrid>

					<h:outputText
						value="#{labels.mockdata_upload_hint_no_interface_method_selected}"
						rendered="#{uploadMockdata.hintNoInterfaceMethodSelectedVisible}" />


					<p:panel header="#{labels.upload}" style="margin-top: 30px">

						<p:fileUpload widgetVar="uploadMockdataWidget"
							fileUploadListener="#{uploadMockdata.uploadMockData}"
							oncomplete="handleFileUploaded(PF('uploadMockdataWidget'), useUploadedMockData);"
							mode="advanced" multiple="true" chooseIcon="#{labels.choose}"
							uploadLabel="#{labels.upload}" cancelLabel="#{labels.cancel}"
							sizeLimit="1048576" allowTypes="/(\.|\/)(txt|xml|json)$/" />

						<p:remoteCommand name="useUploadedMockData"
							actionListener="#{uploadMockdata.useUploadedMockData}" />

						<script type="text/javascript">
			function handleFileUploaded(fileupload, remoteCmd)
			{
				if(fileupload.files.length === 0)
				{
					if(remoteCmd)
					{
						remoteCmd();
					}
				}
			}
		</script>
					</p:panel>

					<p:commandButton style="margin-top: 30px" value="#{labels.cancel}"
						action="#{uploadMockdata.cancel()}" />

				</div>

				<div class="ui-g-12"></div>

			</div>

		</p:panel>

	</h:form>

</h:body>

</html>